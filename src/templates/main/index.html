{% extends 'base.html' %}

{% load static %}

{% block js %}
    {{  block.super }}
    <script type="text/javascript" src="{% static 'jquery/dashboard.js' %}"></script>
    <script>
    jQuery(function($) {
       var URL = '{% url "main:remove_shopping" %}';
        $('.remove-product').on('click', function() {
            var $this = $(this);
            var product_id = $this.data('product-id');
            $.post(URL,{'product_id':product_id},function(){
                $this.parents('.product-item').remove();
            })
            
            return false;
        });

    });
    </script>
{% endblock %}

{% block container %}
    <h3>You logged in as {{ user }}, these are your dashboards</h3>
    <!-- Choose list !-->
    <div class="choose_list">
        {% for listprod in listproduct %}
        <p>{{ listprod.name}}</p>
        {% endfor %}
    </div>
    <!-- AddProduct form !-->
    <div class="add_form">
    <form action="." method="post">
        {% csrf_token %}
        <table>
            {{ form }}
            <tr>
                <td><input type="submit" value="Submit" class="btn btn-primary" /></td>
                <td></td>
            </tr>
        </table>
    </form>
    </div>
    <!-- Displaying elements in current dashboard !-->

    <div id="selector">
        <p>Shopping lists attacked to this dashboard :</p>
        {% for prod in curr_buylist.products.all %}
            <p class="product-item">
                {{ prod }}
                <a href="#" data-product-id='{{ prod.id }}' class="btn btn-success remove-product">Remove</a>
            </p>
        {% endfor %}
        <br>
    </div>
{% endblock %}

